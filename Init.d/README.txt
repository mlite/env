Borrowed from some opensource projects, but I forgot the source. Will put a link here once I found it. 
